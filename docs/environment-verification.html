<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Satoshi's Fury - ç¯å¢ƒé…ç½®éªŒè¯å·¥å…·</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            padding: 40px;
        }
        h1 {
            color: #333;
            margin-bottom: 10px;
            font-size: 28px;
        }
        .subtitle {
            color: #666;
            margin-bottom: 30px;
            font-size: 14px;
        }
        .section {
            margin-bottom: 30px;
        }
        .section-title {
            color: #667eea;
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
        }
        .check-item {
            display: flex;
            align-items: center;
            padding: 12px;
            margin-bottom: 8px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #ddd;
        }
        .check-item.success {
            background: #d4edda;
            border-left-color: #28a745;
        }
        .check-item.error {
            background: #f8d7da;
            border-left-color: #dc3545;
        }
        .check-item.warning {
            background: #fff3cd;
            border-left-color: #ffc107;
        }
        .icon {
            width: 24px;
            height: 24px;
            margin-right: 12px;
            flex-shrink: 0;
        }
        .label {
            flex: 1;
            font-weight: 500;
            color: #333;
        }
        .value {
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 12px;
            color: #666;
            background: white;
            padding: 4px 8px;
            border-radius: 4px;
            max-width: 400px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        .btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s;
        }
        .btn:hover {
            background: #5568d3;
        }
        .alert {
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .alert.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .alert.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .alert.warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        .summary {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
        }
        .summary-card {
            flex: 1;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }
        .summary-card.total {
            background: #e3f2fd;
            color: #1976d2;
        }
        .summary-card.passed {
            background: #d4edda;
            color: #28a745;
        }
        .summary-card.failed {
            background: #f8d7da;
            color: #dc3545;
        }
        .summary-number {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        .summary-label {
            font-size: 14px;
            opacity: 0.8;
        }
        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” ç¯å¢ƒé…ç½®éªŒè¯å·¥å…·</h1>
        <p class="subtitle">ç”¨äºéªŒè¯ Satoshi's Fury ç”Ÿäº§ç¯å¢ƒé…ç½®æ˜¯å¦æ­£ç¡®</p>
        
        <div id="summary" style="display: none;">
            <div class="summary">
                <div class="summary-card total">
                    <div class="summary-number" id="totalCount">0</div>
                    <div class="summary-label">æ€»æ£€æŸ¥é¡¹</div>
                </div>
                <div class="summary-card passed">
                    <div class="summary-number" id="passedCount">0</div>
                    <div class="summary-label">é€šè¿‡</div>
                </div>
                <div class="summary-card failed">
                    <div class="summary-number" id="failedCount">0</div>
                    <div class="summary-label">å¤±è´¥</div>
                </div>
            </div>
        </div>

        <div id="results"></div>

        <div style="text-align: center; margin-top: 30px;">
            <button class="btn" onclick="runChecks()">å¼€å§‹æ£€æŸ¥</button>
        </div>

        <div class="section" style="margin-top: 40px;">
            <div class="section-title">ğŸ“– ä½¿ç”¨è¯´æ˜</div>
            <ol style="padding-left: 20px; color: #666; line-height: 1.8;">
                <li>å°†æ­¤æ–‡ä»¶éƒ¨ç½²åˆ°ä½ çš„ç½‘ç«™æ ¹ç›®å½•</li>
                <li>è®¿é—® <code>https://your-domain.vercel.app/environment-verification.html</code></li>
                <li>ç‚¹å‡»"å¼€å§‹æ£€æŸ¥"æŒ‰é’®</li>
                <li>æŸ¥çœ‹æ£€æŸ¥ç»“æœï¼Œçº¢è‰²é¡¹ç›®éœ€è¦åœ¨ Vercel ä¸­é…ç½®ç¯å¢ƒå˜é‡</li>
            </ol>
        </div>
    </div>

    <script>
        // å…³é”®é…ç½®é¡¹æ£€æŸ¥åˆ—è¡¨
        const checks = [
            {
                name: 'åŒºå—é“¾ç½‘ç»œ ID',
                key: 'NEXT_PUBLIC_CHAIN_ID',
                expected: '8453',
                critical: true,
                description: 'å¿…é¡»ä¸º 8453 (Base Mainnet)ï¼Œå¦åˆ™ä¼šä½¿ç”¨æµ‹è¯•ç½‘é…ç½®'
            },
            {
                name: 'Base Mainnet RPC URL',
                key: 'NEXT_PUBLIC_BASE_MAINNET_RPC_URL',
                pattern: /^https:\/\/.*alchemy.*\/v2\//,
                critical: true,
                description: 'ä¸»ç½‘ RPC èŠ‚ç‚¹ URL'
            },
            {
                name: '1011 Token ä¸»ç½‘åœ°å€',
                key: 'NEXT_PUBLIC_TOKEN_1011_MAINNET',
                pattern: /^0x[a-fA-F0-9]{40}$/,
                critical: true,
                description: '1011 Token åˆçº¦åœ°å€'
            },
            {
                name: 'LP Staking ä¸»ç½‘åˆçº¦',
                key: 'NEXT_PUBLIC_LP_STAKING_CONTRACT_MAINNET',
                expected: '0xbB0A0222aCbe664aAaaA6dF5210D7E99E2C935Ac',
                critical: true,
                description: 'LP è´¨æŠ¼åˆçº¦åœ°å€ï¼ˆPhase IIï¼‰'
            },
            {
                name: 'LP Token ä¸»ç½‘åœ°å€',
                key: 'NEXT_PUBLIC_LP_TOKEN_MAINNET',
                pattern: /^0x[a-fA-F0-9]{40}$/,
                critical: true,
                description: 'ETH-1011 LP Token åœ°å€'
            },
            {
                name: 'Uniswap Router ä¸»ç½‘',
                key: 'NEXT_PUBLIC_UNISWAP_ROUTER_MAINNET',
                pattern: /^0x[a-fA-F0-9]{40}$/,
                critical: false,
                description: 'Uniswap V2 Router åœ°å€'
            },
            {
                name: 'WETH ä¸»ç½‘åœ°å€',
                key: 'NEXT_PUBLIC_WETH_MAINNET',
                expected: '0x4200000000000000000000000000000000000006',
                critical: false,
                description: 'Base é“¾ WETH åˆçº¦åœ°å€'
            },
            {
                name: 'Supabase URL',
                key: 'NEXT_PUBLIC_SUPABASE_URL',
                pattern: /^https:\/\/.*\.supabase\.co$/,
                critical: true,
                description: 'Supabase API URL'
            },
            {
                name: 'Web3Auth Client ID',
                key: 'NEXT_PUBLIC_WEB3AUTH_CLIENT_ID',
                pattern: /^[A-Za-z0-9_-]{50,}$/,
                critical: true,
                description: 'Web3Auth å®¢æˆ·ç«¯ ID'
            },
            {
                name: 'Telegram Bot',
                key: 'NEXT_PUBLIC_TELEGRAM_BOT_USERNAME',
                expected: 'Fury1011Bot',
                critical: true,
                description: 'Telegram ç™»å½• Bot ç”¨æˆ·å'
            },
            {
                name: 'Google Analytics',
                key: 'NEXT_PUBLIC_GA_MEASUREMENT_ID',
                pattern: /^G-[A-Z0-9]+$/,
                critical: false,
                description: 'Google Analytics æµ‹é‡ ID'
            }
        ];

        function runChecks() {
            const resultsDiv = document.getElementById('results');
            const summaryDiv = document.getElementById('summary');
            resultsDiv.innerHTML = '';
            
            let passed = 0;
            let failed = 0;
            const results = [];

            // å…³é”®é…ç½®æ£€æŸ¥
            const criticalSection = document.createElement('div');
            criticalSection.className = 'section';
            criticalSection.innerHTML = '<div class="section-title">â­ å…³é”®é…ç½®é¡¹</div>';
            
            const optionalSection = document.createElement('div');
            optionalSection.className = 'section';
            optionalSection.innerHTML = '<div class="section-title">ğŸ“¦ å¯é€‰é…ç½®é¡¹</div>';

            checks.forEach(check => {
                const value = getEnvValue(check.key);
                const result = validateCheck(check, value);
                
                if (result.status === 'success') {
                    passed++;
                } else {
                    failed++;
                }

                const item = createCheckItem(check, result, value);
                
                if (check.critical) {
                    criticalSection.appendChild(item);
                } else {
                    optionalSection.appendChild(item);
                }
            });

            resultsDiv.appendChild(criticalSection);
            resultsDiv.appendChild(optionalSection);

            // æ˜¾ç¤ºæ‘˜è¦
            summaryDiv.style.display = 'block';
            document.getElementById('totalCount').textContent = checks.length;
            document.getElementById('passedCount').textContent = passed;
            document.getElementById('failedCount').textContent = failed;

            // æ˜¾ç¤ºæ€»ä½“çŠ¶æ€
            const alertDiv = document.createElement('div');
            if (failed === 0) {
                alertDiv.className = 'alert success';
                alertDiv.innerHTML = '<strong>âœ… æ‰€æœ‰é…ç½®æ£€æŸ¥é€šè¿‡ï¼</strong><br>ä½ çš„ç¯å¢ƒé…ç½®æ­£ç¡®ï¼Œå¯ä»¥æ­£å¸¸ä½¿ç”¨ã€‚';
            } else {
                const criticalFailed = checks.filter(c => c.critical && validateCheck(c, getEnvValue(c.key)).status !== 'success').length;
                if (criticalFailed > 0) {
                    alertDiv.className = 'alert error';
                    alertDiv.innerHTML = `<strong>âŒ å‘ç° ${criticalFailed} ä¸ªå…³é”®é…ç½®é—®é¢˜ï¼</strong><br>è¯·åœ¨ Vercel Dashboard â†’ Settings â†’ Environment Variables ä¸­æ·»åŠ ç¼ºå¤±çš„é…ç½®é¡¹ã€‚`;
                } else {
                    alertDiv.className = 'alert warning';
                    alertDiv.innerHTML = `<strong>âš ï¸ å‘ç° ${failed} ä¸ªå¯é€‰é…ç½®é—®é¢˜</strong><br>ä¸å½±å“æ ¸å¿ƒåŠŸèƒ½ï¼Œä½†å»ºè®®å®Œå–„é…ç½®ã€‚`;
                }
            }
            resultsDiv.insertBefore(alertDiv, resultsDiv.firstChild);
        }

        function getEnvValue(key) {
            // åœ¨æµè§ˆå™¨ä¸­ï¼ŒNext.js ä¼šå°† NEXT_PUBLIC_ å‰ç¼€çš„ç¯å¢ƒå˜é‡æ³¨å…¥åˆ° process.env
            return process.env[key] || window.__NEXT_DATA__?.props?.pageProps?.[key] || null;
        }

        function validateCheck(check, value) {
            if (!value || value === 'undefined') {
                return { status: 'error', message: 'æœªé…ç½®' };
            }

            if (check.expected && value !== check.expected) {
                return { 
                    status: 'error', 
                    message: `æœŸæœ›å€¼: ${check.expected}` 
                };
            }

            if (check.pattern && !check.pattern.test(value)) {
                return { 
                    status: 'error', 
                    message: 'æ ¼å¼ä¸æ­£ç¡®' 
                };
            }

            return { status: 'success', message: 'é…ç½®æ­£ç¡®' };
        }

        function createCheckItem(check, result, value) {
            const item = document.createElement('div');
            item.className = `check-item ${result.status}`;
            
            const icon = result.status === 'success' ? 'âœ…' : 'âŒ';
            const displayValue = value || 'æœªé…ç½®';
            
            item.innerHTML = `
                <span class="icon">${icon}</span>
                <span class="label">
                    ${check.name}
                    ${check.critical ? '<span style="color: #dc3545; font-size: 12px;">(å¿…éœ€)</span>' : ''}
                </span>
                <span class="value" title="${displayValue}">${displayValue}</span>
            `;
            
            return item;
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨è¿è¡Œæ£€æŸ¥
        window.addEventListener('load', () => {
            // å»¶è¿Ÿ 500ms ç¡®ä¿ç¯å¢ƒå˜é‡å·²åŠ è½½
            setTimeout(runChecks, 500);
        });
    </script>
</body>
</html>
